# Deployment Guide for IIITA Helpdesk

## Render Deployment

### Option 1: Using Render Dashboard (Recommended)

#### Backend Deployment:
1. **Create MySQL Database:**
   - Go to [Render Dashboard](https://dashboard.render.com)
   - Click "New" → "PostgreSQL" (or use external MySQL service)
   - Name: `iiita-helpdesk-db`
   - Plan: Free or Starter
   - Save the connection details

2. **Deploy Backend API:**
   - Click "New" → "Web Service"
   - Connect your GitHub repository
   - Settings:
     - **Name:** `iiita-helpdesk-api`
     - **Environment:** Node
     - **Build Command:** `cd backend && npm install`
     - **Start Command:** `cd backend && npm start`
     - **Health Check Path:** `/health`
   
3. **Environment Variables:**
   ```
   NODE_ENV=production
   JWT_SECRET=[Auto-generated by Render]
   DB_HOST=[Your MySQL host]
   DB_PORT=3306
   DB_USER=[Your MySQL username]
   DB_PASSWORD=[Your MySQL password]
   DB_NAME=iiita_helpdesk
   FRONTEND_URL=https://your-frontend-domain.vercel.app
   ```

#### Frontend Deployment (Vercel):
1. **Deploy to Vercel:**
   - Connect your GitHub repo to Vercel
   - Framework Preset: Vite
   - Build Command: `npm run build`
   - Output Directory: `dist`

2. **Environment Variables in Vercel:**
   ```
   VITE_API_URL=https://your-backend-app.onrender.com/api
   ```

### Option 2: Using Render Blueprint

1. **Fork the repository**
2. **Create render.yaml** (already included)
3. **Deploy via Render Dashboard:**
   - Go to Render Dashboard
   - Click "New" → "Blueprint"
   - Connect your repository
   - Render will automatically deploy both services

### Option 3: Manual MySQL Setup

If you prefer external MySQL hosting:

1. **Railway MySQL:**
   - Create account at [Railway](https://railway.app)
   - Create new project → Add MySQL
   - Get connection details

2. **PlanetScale (Recommended):**
   - Create account at [PlanetScale](https://planetscale.com)
   - Create database: `iiita-helpdesk`
   - Get connection string

3. **AWS RDS or Google Cloud SQL:**
   - Create MySQL instance
   - Configure security groups
   - Get connection details

## Local Development with Docker

1. **Clone the repository:**
   ```bash
   git clone <your-repo-url>
   cd iiita-helpdesk
   ```

2. **Start with Docker Compose:**
   ```bash
   docker-compose up -d
   ```

3. **Access the application:**
   - Frontend: http://localhost:5173
   - Backend API: http://localhost:5000
   - MySQL: localhost:3306

4. **Stop the services:**
   ```bash
   docker-compose down
   ```

## Database Setup

1. **Run the schema:**
   - Copy content from `backend/database/schema.sql`
   - Execute in your MySQL database
   - This creates tables and sample users

2. **Default Login Credentials:**
   - **Admin:** admin@iiita.ac.in / admin123
   - **Student:** student@iiita.ac.in / student123

## Environment Variables Reference

### Backend (.env):
```env
NODE_ENV=production
PORT=5000
JWT_SECRET=your-super-secret-jwt-key
DB_HOST=your-mysql-host
DB_PORT=3306
DB_USER=your-mysql-username
DB_PASSWORD=your-mysql-password
DB_NAME=iiita_helpdesk
FRONTEND_URL=https://your-frontend-domain.com
```

### Frontend (.env):
```env
VITE_API_URL=https://your-backend-domain.com/api
```

## Post-Deployment Checklist

- [ ] Backend health check returns 200 OK
- [ ] Database connection successful
- [ ] Frontend can communicate with backend
- [ ] Authentication works (login/register)
- [ ] Students can create complaints
- [ ] Admins can manage complaints
- [ ] CORS configured correctly
- [ ] SSL certificates active (HTTPS)

## Troubleshooting

### Common Issues:

1. **CORS Errors:**
   - Ensure `FRONTEND_URL` is set correctly in backend
   - Check Render service URLs match environment variables

2. **Database Connection:**
   - Verify all DB environment variables
   - Check database service is running
   - Ensure firewall allows connections

3. **Authentication Issues:**
   - Verify `JWT_SECRET` is set
   - Check token expiration settings
   - Ensure HTTPS is enabled in production

4. **Build Failures:**
   - Check Node.js version compatibility
   - Verify all dependencies are listed in package.json
   - Review build logs for specific errors

## Monitoring

- **Render Dashboard:** Monitor service health and logs
- **Database Metrics:** Track connection pool and query performance
- **Error Tracking:** Consider integrating Sentry for error monitoring
- **Uptime Monitoring:** Use services like UptimeRobot

## Scaling Considerations

- **Database:** Upgrade to higher tier for more connections
- **Backend:** Enable auto-scaling in Render
- **CDN:** Use Vercel's global CDN for frontend assets
- **Caching:** Implement Redis for session management